<div class="mx-auto max-w-screen-2xl px-4 md:px-8 mt-16">
  <div class="mb-6 flex flex-col md:flex-row items-end justify-between gap-4">
    <div class="w-full border-gray-300">
      <ul id="messageList">
        <% last_sender_id = nil %>
        <% @messages.each do |message| %>
          <% unless message.sender.id == last_sender_id %>
            <% last_sender_id = message.sender.id %>
            <li class="flex items-center py-2 border-b border-gray-200">
              <div>
                <% if message.sender.profile_image.present? %>
                  <%= link_to user_user_message_path(user_id: message.sender.id, id: message.id) do %>
                    <%= image_tag message.sender.profile_image, class: "h-10 w-10 rounded-full flex items-center justify-center mr-4" %>
                  <% end %>
                <% else %>
                  <%= link_to user_user_message_path(user_id: message.sender.id, id: message.id) do %>
                    <%= image_tag "no_image.jpg", class: "w-10 h-10 rounded-full flex items-center justify-center mr-4" %>
                  <% end %>
                <% end %>
              </div>
              <div>
                <h3 class="font-semibold">
                  <%= link_to message.sender.user_name, user_user_message_path(user_id: message.sender.id, id: message.id) %>
                </h3>
                <p class="text-gray-500"><%= message.content %></p>
              </div>
            </li>
          <% end %>
        <% end %>
      </ul>
    </div>
  </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const messageItems = document.querySelectorAll("#messageList li");
        messageItems.forEach(function(item) {
            item.addEventListener("click", function() {
                // メッセージアイテムがクリックされたときの処理
                messageItems.forEach(function(item) {
                    item.classList.remove("bg-blue-100"); // 全てのアイテムの背景色をリセット
                });
                this.classList.add("bg-blue-100"); // クリックされたアイテムに背景色を追加
            });
        });
    });
</script>
